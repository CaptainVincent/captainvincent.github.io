
<head>
    <meta charset="utf-8">

    <title>Kelly Formula / 凱利公式 － 風險控管</title>
    <meta name="description" content="">

    <meta name="HandheldFriendly" content="True">
    <meta name="viewport" content="width=device-width,minimum-scale=1,initial-scale=1">

    <link rel="shortcut icon" href="../../favicon.ico">

    <link rel="canonical" href="../index.html">
    <meta name="referrer" content="no-referrer-when-downgrade">
    
    <meta property="og:site_name" content="Hello World! I'm Vincent.">
    <meta property="og:type" content="article">
    <meta property="og:title" content="Kelly Formula / 凱利公式 － 風險控管">
    <meta property="og:description" content="投資 vs 投機 vs 賭博, 不管你自認為是使用以上三種策略的那一種人, 今天要介紹的是一門讓你在這條路上可以走得更遠、更久的準則－Kelly Formula, 先來上一堂數學課吧!  Kelly Formula b : 賠率 (獲勝後的報償比上本金的比例, ex. 賭上 1 元, 獲勝可拿回 1+b 元) p : 勝率 (獲勝的機率) q : 敗率 (1-p) f : 為使用現有資金應進行投注的比例 Kelly Formula 為求最大期望值時, 應投入的資金比例 (其中 b、p、q 皆為不變常數)  from Wiki   證明 Definition Xn : 表示 經過 n 次賭局後所剩的資金">
    <meta property="og:url" content="http://captainvincent.github.io/kelly-formula/">
    <meta property="article:published_time" content="2016-03-11T10:57:55.000Z">
    <meta property="article:modified_time" content="2016-03-26T17:25:07.000Z">
    <meta property="article:publisher" content="https://www.facebook.com/UndercoverEngineer">
    <meta name="twitter:card" content="summary">
    <meta name="twitter:title" content="Kelly Formula / 凱利公式 － 風險控管">
    <meta name="twitter:description" content="投資 vs 投機 vs 賭博, 不管你自認為是使用以上三種策略的那一種人, 今天要介紹的是一門讓你在這條路上可以走得更遠、更久的準則－Kelly Formula, 先來上一堂數學課吧!  Kelly Formula b : 賠率 (獲勝後的報償比上本金的比例, ex. 賭上 1 元, 獲勝可拿回 1+b 元) p : 勝率 (獲勝的機率) q : 敗率 (1-p) f : 為使用現有資金應進行投注的比例 Kelly Formula 為求最大期望值時, 應投入的資金比例 (其中 b、p、q 皆為不變常數)  from Wiki   證明 Definition Xn : 表示 經過 n 次賭局後所剩的資金">
    <meta name="twitter:url" content="http://captainvincent.github.io/kelly-formula/">
    <meta name="twitter:label1" content="Written by">
    <meta name="twitter:data1" content="Captain Vincent">
    
    <script type="application/ld+json">
{
    "@context": "https://schema.org",
    "@type": "Article",
    "publisher": {
        "@type": "Organization",
        "name": "Hello World! I&#x27;m Vincent.",
        "logo": "http://captainvincent.github.io/ghost/img/ghosticon.jpg"
    },
    "author": {
        "@type": "Person",
        "name": "Captain Vincent",
        "image": {
            "@type": "ImageObject",
            "url": "http://captainvincent.github.io/content/images/2016/11/--.JPG",
            "width": 889,
            "height": 1080
        },
        "url": "http://captainvincent.github.io/author/vincent/",
        "sameAs": []
    },
    "headline": "Kelly Formula / 凱利公式 － 風險控管",
    "url": "http://captainvincent.github.io/kelly-formula/",
    "datePublished": "2016-03-11T10:57:55.000Z",
    "dateModified": "2016-03-26T17:25:07.000Z",
    "description": "投資 vs 投機 vs 賭博, 不管你自認為是使用以上三種策略的那一種人, 今天要介紹的是一門讓你在這條路上可以走得更遠、更久的準則－Kelly Formula, 先來上一堂數學課吧!  Kelly Formula b : 賠率 (獲勝後的報償比上本金的比例, ex. 賭上 1 元, 獲勝可拿回 1+b 元) p : 勝率 (獲勝的機率) q : 敗率 (1-p) f : 為使用現有資金應進行投注的比例 Kelly Formula 為求最大期望值時, 應投入的資金比例 (其中 b、p、q 皆為不變常數)  from Wiki   證明 Definition Xn : 表示 經過 n 次賭局後所剩的資金",
    "mainEntityOfPage": {
        "@type": "WebPage",
        "@id": "http://captainvincent.github.io"
    }
}
    </script>

    <meta name="generator" content="Ghost 0.11">
    <link rel="alternate" type="application/rss+xml" title="Hello World! I'm Vincent." href="../../rss/index.html">

    <link rel="stylesheet" type="text/css" href="https://fonts.googleapis.com/css?family=Merriweather:300,700,700italic,300italic%7COpen+Sans:700,600,400">
    <style amp-custom>
        /* ==========================================================================
           Table of Contents
           ========================================================================== */

        /*

            0. Normalize
            1. General
            2. Utilities
            3. AMP Post
            4. Footer

        */

        /* ==========================================================================
           0. normalize.css v3.0.3 | MIT License | git.io/normalize | (minified)
           ========================================================================== */

        html {
            font-family: sans-serif;

            -ms-text-size-adjust: 100%;
            -webkit-text-size-adjust: 100%;
        }
        body {
            margin: 0;
        }
        article,
        aside,
        details,
        figcaption,
        figure,
        footer,
        header,
        main,
        menu,
        nav,
        section,
        summary {
            display: block;
        }
        audio,
        canvas,
        progress,
        video {
            display: inline-block;
            vertical-align: baseline;
        }
        audio:not([controls]) {
            display: none;
            height: 0;
        }
        [hidden],
        template {
            display: none;
        }
        a {
            background-color: transparent;
        }
        a:active,
        a:hover {
            outline: 0;
        }
        abbr[title] {
            border-bottom: 1px dotted;
        }
        b,
        strong {
            font-weight: bold;
        }
        dfn {
            font-style: italic;
        }
        h1 {
            margin: 0.67em 0;
            font-size: 2em;
        }
        mark {
            background: #ff0;
            color: #000;
        }
        small {
            font-size: 80%;
        }
        sub,
        sup {
            position: relative;
            vertical-align: baseline;
            font-size: 75%;
            line-height: 0;
        }
        sup {
            top: -0.5em;
        }
        sub {
            bottom: -0.25em;
        }
        img {
            border: 0;
        }
        amp-img {
            border: 0;
        }
        svg:not(:root) {
            overflow: hidden;
        }
        figure {
            margin: 1em 40px;
        }
        hr {
            box-sizing: content-box;
            height: 0;
        }
        pre {
            overflow: auto;
        }
        code,
        kbd,
        pre,
        samp {
            font-family: monospace, monospace;
            font-size: 1em;
        }
        button,
        input,
        optgroup,
        select,
        textarea {
            margin: 0;
            color: inherit;
            font: inherit;
        }
        button {
            overflow: visible;
        }
        button,
        select {
            text-transform: none;
        }
        button,
        html input[type="button"],
        input[type="reset"],
        input[type="submit"] {
            cursor: pointer;

            -webkit-appearance: button;
        }
        button[disabled],
        html input[disabled] {
            cursor: default;
        }
        button::-moz-focus-inner,
        input::-moz-focus-inner {
            padding: 0;
            border: 0;
        }
        input {
            line-height: normal;
        }
        input[type="checkbox"],
        input[type="radio"] {
            box-sizing: border-box;
            padding: 0;
        }
        input[type="number"]::-webkit-inner-spin-button,
        input[type="number"]::-webkit-outer-spin-button {
            height: auto;
        }
        input[type="search"] {
            -webkit-appearance: textfield;
        }
        input[type="search"]::-webkit-search-cancel-button,
        input[type="search"]::-webkit-search-decoration {
            -webkit-appearance: none;
        }
        fieldset {
            margin: 0 2px;
            padding: 0.35em 0.625em 0.75em;
            border: 1px solid #c0c0c0;
        }
        legend {
            padding: 0;
            border: 0;
        }
        textarea {
            overflow: auto;
        }
        optgroup {
            font-weight: bold;
        }
        table {
            border-spacing: 0;
            border-collapse: collapse;
        }
        td,
        th {
            padding: 0;
        }


        /* ==========================================================================
           1. General - Setting up some base styles
           ========================================================================== */

        html {
            max-height: 100%;
            height: 100%;
            font-size: 62.5%;

            -webkit-tap-highlight-color: rgba(0, 0, 0, 0);
        }

        body {
            max-height: 100%;
            height: 100%;
            color: #3a4145;
            background: #f4f8fb;
            letter-spacing: 0.01rem;
            font-family: "Merriweather", serif;
            font-size: 1.8rem;
            line-height: 1.75em;
            text-rendering: geometricPrecision;

            -webkit-font-feature-settings: "kern" 1;
            -moz-font-feature-settings: "kern" 1;
            -o-font-feature-settings: "kern" 1;
        }

        ::-moz-selection {
            background: #d6edff;
        }

        ::selection {
            background: #d6edff;
        }

        h1,
        h2,
        h3,
        h4,
        h5,
        h6 {
            margin: 0 0 0.3em 0;
            color: #2e2e2e;
            font-family: "Open Sans", sans-serif;
            line-height: 1.15em;
            text-rendering: geometricPrecision;

            -webkit-font-feature-settings: "dlig" 1, "liga" 1, "lnum" 1, "kern" 1;
            -moz-font-feature-settings: "dlig" 1, "liga" 1, "lnum" 1, "kern" 1;
            -o-font-feature-settings: "dlig" 1, "liga" 1, "lnum" 1, "kern" 1;
        }

        h1 {
            text-indent: -2px;
            letter-spacing: -1px;
            font-size: 2.6rem;
        }

        h2 {
            letter-spacing: 0;
            font-size: 2.4rem;
        }

        h3 {
            letter-spacing: -0.6px;
            font-size: 2.1rem;
        }

        h4 {
            font-size: 1.9rem;
        }

        h5 {
            font-size: 1.8rem;
        }

        h6 {
            font-size: 1.8rem;
        }

        a {
            color: #4a4a4a;
        }

        a:hover {
            color: #111;
        }

        p,
        ul,
        ol,
        dl {
            margin: 0 0 2.5rem 0;
            font-size: 1.5rem;
            text-rendering: geometricPrecision;

            -webkit-font-feature-settings: "liga" 1, "onum" 1, "kern" 1;
            -moz-font-feature-settings: "liga" 1, "onum" 1, "kern" 1;
            -o-font-feature-settings: "liga" 1, "onum" 1, "kern" 1;
        }

        ol,
        ul {
            padding-left: 2em;
        }

        ol ol,
        ul ul,
        ul ol,
        ol ul {
            margin: 0 0 0.4em 0;
            padding-left: 2em;
        }

        dl dt {
            float: left;
            clear: left;
            overflow: hidden;
            margin-bottom: 1em;
            width: 180px;
            text-align: right;
            text-overflow: ellipsis;
            white-space: nowrap;
            font-weight: 700;
        }

        dl dd {
            margin-bottom: 1em;
            margin-left: 200px;
        }

        li {
            margin: 0.4em 0;
        }

        li li {
            margin: 0;
        }

        hr {
            display: block;
            margin: 1.75em 0;
            padding: 0;
            height: 1px;
            border: 0;
            border-top: #efefef 1px solid;
        }

        blockquote {
            box-sizing: border-box;
            margin: 1.75em 0 1.75em 0;
            padding: 0 0 0 1.75em;
            border-left: #4a4a4a 0.4em solid;

            -moz-box-sizing: border-box;
        }

        blockquote p {
            margin: 0.8em 0;
            font-style: italic;
        }

        blockquote small {
            display: inline-block;
            margin: 0.8em 0 0.8em 1.5em;
            color: #ccc;
            font-size: 0.9em;
        }

        blockquote small:before {
            content: "\2014 \00A0";
        }

        blockquote cite {
            font-weight: 700;
        }

        blockquote cite a {
            font-weight: normal;
        }

        mark {
            background-color: #fdffb6;
        }

        code,
        tt {
            padding: 1px 3px;
            border: #e3edf3 1px solid;
            background: #f7fafb;
            border-radius: 2px;
            white-space: pre-wrap;
            font-family: Inconsolata, monospace, sans-serif;
            font-size: 0.85em;
            font-feature-settings: "liga" 0;

            -webkit-font-feature-settings: "liga" 0;
            -moz-font-feature-settings: "liga" 0;
        }

        pre {
            overflow: auto;
            box-sizing: border-box;
            margin: 0 0 1.75em 0;
            padding: 10px;
            width: 100%;
            border: #e3edf3 1px solid;
            background: #f7fafb;
            border-radius: 3px;
            white-space: pre;
            font-family: Inconsolata, monospace, sans-serif;
            font-size: 0.9em;

            -moz-box-sizing: border-box;
        }

        pre code,
        pre tt {
            padding: 0;
            border: none;
            background: transparent;
            white-space: pre-wrap;
            font-size: inherit;
        }

        kbd {
            display: inline-block;
            margin-bottom: 0.4em;
            padding: 1px 8px;
            border: #ccc 1px solid;
            background: #f4f4f4;
            border-radius: 4px;
            box-shadow: 0 1px 0 rgba(0, 0, 0, 0.2),
            0 1px 0 0 #fff inset;
            color: #666;
            text-shadow: #fff 0 1px 0;
            font-size: 0.9em;
            font-weight: 700;
        }

        table {
            box-sizing: border-box;
            margin: 1.75em 0;
            max-width: 100%;
            width: 100%;
            background-color: transparent;

            -moz-box-sizing: border-box;
        }

        table th,
        table td {
            padding: 8px;
            border-top: #efefef 1px solid;
            vertical-align: top;
            text-align: left;
            line-height: 20px;
        }

        table th {
            color: #000;
        }

        table caption + thead tr:first-child th,
        table caption + thead tr:first-child td,
        table colgroup + thead tr:first-child th,
        table colgroup + thead tr:first-child td,
        table thead:first-child tr:first-child th,
        table thead:first-child tr:first-child td {
            border-top: 0;
        }

        table tbody + tbody {
            border-top: #efefef 2px solid;
        }

        table table table {
            background-color: #fff;
        }

        table tbody > tr:nth-child(odd) > td,
        table tbody > tr:nth-child(odd) > th {
            background-color: #f6f6f6;
        }

        table.plain tbody > tr:nth-child(odd) > td,
        table.plain tbody > tr:nth-child(odd) > th {
            background: transparent;
        }

        iframe,
        amp-iframe,
        .fluid-width-video-wrapper {
            display: block;
            margin: 1.75em 0;
        }

        /* When a video is inside the fitvids wrapper, drop the
        margin on the iframe, cause it breaks stuff. */
        .fluid-width-video-wrapper iframe,
        .fluid-width-video-wrapper amp-iframe {
            margin: 0;
        }

        textarea,
        select,
        input {
            margin: 0 0 5px 0;
            padding: 6px 9px;
            width: 260px;
            outline: 0;
            border: #e7eef2 1px solid;
            background: #fff;
            border-radius: 4px;
            box-shadow: none;
            font-family: "Open Sans", sans-serif;
            font-size: 1.6rem;
            line-height: 1.4em;
            font-weight: 100;

            -webkit-appearance: none;
        }

        textarea {
            min-width: 250px;
            min-height: 80px;
            max-width: 340px;
            width: 100%;
            height: auto;
        }

        input[type="text"]:focus,
        input[type="email"]:focus,
        input[type="search"]:focus,
        input[type="tel"]:focus,
        input[type="url"]:focus,
        input[type="password"]:focus,
        input[type="number"]:focus,
        input[type="date"]:focus,
        input[type="month"]:focus,
        input[type="week"]:focus,
        input[type="time"]:focus,
        input[type="datetime"]:focus,
        input[type="datetime-local"]:focus,
        textarea:focus {
            outline: none;
            outline-width: 0;
            border: #bbc7cc 1px solid;
            background: #fff;
        }

        select {
            width: 270px;
            height: 30px;
            line-height: 30px;
        }

        /* ==========================================================================
           2. Utilities
           ========================================================================== */

        /* Clears shit */
        .clearfix:before,
        .clearfix:after {
            content: " ";
            display: table;
        }
        .clearfix:after {
            clear: both;
        }
        .clearfix {
            zoom: 1;
        }

        /* ==========================================================================
           3. AMP Post
           ========================================================================== */



        .main-header {
            position: relative;
            display: table;
            overflow: hidden;
            box-sizing: border-box;
            width: 100%;
            height: 50px;
            background: #5ba4e5 no-repeat center center;
            background-size: cover;
            text-align: left;

            -webkit-box-sizing: border-box;
            -moz-box-sizing: border-box;
        }

        .content {
            background: #fff;
            padding-top: 15px;
        }
        .blog-title,
        .content {
            margin: auto;
            max-width: 600px;
        }

        .blog-title a {
            display: block;
            padding-right: 16px;
            padding-left: 16px;
            height: 50px;
            color: #fff;
            text-decoration: none;
            font-family: "Open Sans", sans-serif;
            font-size: 16px;
            line-height: 50px;
            font-weight: 600;
        }

        .post {
            position: relative;
            margin-top: 0;
            margin-right: 16px;
            margin-left: 16px;
            padding-bottom: 0;
            max-width: 100%;
            border-bottom: #ebf2f6 1px solid;
            word-wrap: break-word;
            font-size: 0.95em;
            line-height: 1.65em;
        }

        .post-header {
            margin-bottom: 1rem;
        }

        .post-title {
            margin-bottom: 0;
        }

        .post-title a {
            text-decoration: none;
        }

        .post-meta {
            display: block;
            margin: 3px 0 0 0;
            color: #9eabb3;
            font-family: "Open Sans", sans-serif;
            font-size: 1.3rem;
            line-height: 2.2rem;
        }

        .post-meta a {
            color: #9eabb3;
            text-decoration: none;
        }

        .post-meta a:hover {
            text-decoration: underline;
        }

        .post-meta .author {
            margin: 0;
            font-size: 1.3rem;
            line-height: 1.3em;
        }

        .post-date {
            display: inline-block;
            text-transform: uppercase;
            white-space: nowrap;
            font-size: 1.2rem;
            line-height: 1.2em;
        }

        .post-image {
            margin: 0;
            padding-top: 3rem;
            padding-bottom: 30px;
            border-top: 1px #E8E8E8 solid;
        }

        /* Keep images centered, and allow images wider than the main
           text column to break out. */
        .post-content amp-img,
        .post-content amp-anim {
            /* Centers an image by (1) pushing its left edge to the
               center of its container and (2) shifting the entire image
               in the opposite direction by half its own width.
               Works for images that are larger than their containers. */
            position: relative;
            left: 50%;
            display: block;
            padding: 0;
            min-width: 0;
            max-width: 112%; /* fallback when calc doesn't work */
            width: calc(100% + 32px); /* expand with to image + margins */
            height: auto;
            transform: translateX(-50%);

            -webkit-transform: translateX(-50%); /* for Safari and iOS */
            -ms-transform: translateX(-50%); /* for IE9 */
        }

        .footnotes {
            font-size: 1.3rem;
            line-height: 1.6em;
            font-style: italic;
        }

        .footnotes li {
            margin: 0.6rem 0;
        }

        .footnotes p {
            margin: 0;
        }

        .footnotes p a:last-child {
            text-decoration: none;
        }

        /* ==========================================================================
           4. Footer - The bottom the AMP Post
           ========================================================================== */

        .site-footer {
            position: relative;
            margin: 0 auto 20px auto;
            padding: 1rem 15px;
            max-width: 600px;
            color: rgba(0,0,0,0.5);
            font-family: "Open Sans", sans-serif;
            font-size: 1.1rem;
            line-height: 1.75em;
        }

        .site-footer a {
            color: rgba(0,0,0,0.5);
            text-decoration: none;
            font-weight: bold;
        }

        .site-footer a:hover {
            border-bottom: #bbc7cc 1px solid;
        }

        .poweredby {
            display: block;
            float: right;
            width: 45%;
            text-align: right;
        }

        .copyright {
            display: block;
            float: left;
            width: 45%;
        }
    </style>

    <style amp-boilerplate>body{-webkit-animation:-amp-start 8s steps(1,end) 0s 1 normal both;-moz-animation:-amp-start 8s steps(1,end) 0s 1 normal both;-ms-animation:-amp-start 8s steps(1,end) 0s 1 normal both;animation:-amp-start 8s steps(1,end) 0s 1 normal both}@-webkit-keyframes -amp-start{from{visibility:hidden}to{visibility:visible}}@-moz-keyframes -amp-start{from{visibility:hidden}to{visibility:visible}}@-ms-keyframes -amp-start{from{visibility:hidden}to{visibility:visible}}@-o-keyframes -amp-start{from{visibility:hidden}to{visibility:visible}}@keyframes -amp-start{from{visibility:hidden}to{visibility:visible}}</style><noscript><style amp-boilerplate>body{-webkit-animation:none;-moz-animation:none;-ms-animation:none;animation:none}</style></noscript>
    <script async src="https://cdn.ampproject.org/v0.js"></script>

    

</head>

<body class="amp-template">
    <header class="main-header">
        <nav class="blog-title">
            <a href="../../">Hello World! I'm Vincent.</a>
        </nav>
    </header>

    <main class="content" role="main">
        <article class="post">

            <header class="post-header">
                <h1 class="post-title">Kelly Formula / 凱利公式 － 風險控管</h1>
                <section class="post-meta">
                    <p class="author">by <a href="../../author/vincent/">Captain Vincent</a></p>
                    <time class="post-date" datetime="2016-03-11">2016-03-11</time>
                </section>
            </header>
            <section class="post-content">

                <blockquote>
  <p>投資 vs 投機 vs 賭博, 不管你自認為是使用以上三種策略的那一種人, 今天要介紹的是一門讓你在這條路上可以走得更遠、更久的準則－<strong>Kelly Formula</strong>, 先來上一堂數學課吧! </p>
</blockquote>

<h2 id="kellyformula">Kelly Formula</h2>

<p><amp-img src="https://farm2.staticflickr.com/1497/25083691774_dba0e65847_o.jpg" alt="Kelly Formula" width="228" height="98" layout="fixed"></amp-img></p>

<ul>
<li>b : 賠率 (獲勝後的報償比上本金的比例, ex. 賭上 1 元, 獲勝可拿回 1+b 元)</li>
<li>p : 勝率 (獲勝的機率)</li>
<li>q : 敗率 (1-p)</li>
<li>f : 為使用現有資金應進行投注的比例</li>
</ul>

<p>Kelly Formula 為求最大期望值時, 應投入的資金比例 (其中 b、p、q 皆為不變常數) <br>
from <a href="https://zh.wikipedia.org/wiki/%E5%87%B1%E5%88%A9%E5%85%AC%E5%BC%8F">Wiki</a>  </p>

<hr>

<h2 id>證明</h2>

<p><strong>Definition</strong></p>

<ul>
<li>X<sub>n</sub> : 表示 經過 n 次賭局後所剩的資金 (n=0, 表示初始資金)</li>
<li>W<sub>n</sub> : 表示 經過 n 次賭局, Win 的次數</li>
<li>L<sub>n</sub> : 表示 經過 n 次賭局, Loss 的次數</li>
</ul>

<p><strong>Two Cases</strong></p>

<ul>
<li>X<sub>n</sub> = X<sub>n-1</sub> ( 1 + bf )
<br>Win case, 剩餘金額 = 前次金額 * (1 + 賠率*前次投注的比例)  </li>
<li>X<sub>n</sub> = X<sub>n-1</sub> ( 1 - f )
<br>Loss case, 剩餘金額 = 前次金額 * (1 - 前次損失的比例)</li>
</ul>

<p>更進一步可以理解</p>

<p>X<sub>n</sub> = X<sub>0</sub> ( 1 - f ) <sup>Ln</sup> ( 1 + bf ) <sup>Wn</sup> ... (式1) <br>
剩餘金額 = 初始金額 * (失敗 case)<sup>失敗次數</sup> * (勝利 case)<sup>勝利次數</sup> </p>

<blockquote>
  <p>參考文獻中更進一步的將 Loss Case 中的賠率 (賠給對方), 另外定義為 a, 所以整理得到的公式會如下</p>
  
  <p>X<sub>n</sub> = X<sub>0</sub> ( 1 - af ) <sup>Ln</sup> ( 1 + bf ) <sup>Wn</sup> ... (式2)</p>
  
  <p>而 (式1) 只是當 a=1 的 special case (表示當輸了時, 會造成該次投注金額全部損失)</p>
</blockquote>

<p>Reference <a href="https://www.math.washington.edu/~morrow/336_10/papers/jane.pdf">Betting with the Kelly Criterion</a>, Jane Hung (June 2,2010)</p>

<p>這邊先以 (式2) 來求 f 的最佳值, 首先對 <strong>方程式</strong> 的左右兩側同時</p>

<ol>
<li>除以 X<sub>0</sub>  </li>
<li>取 ln (ln = log<sub>e</sub>) <br>
因為 ln 為嚴格遞增函數, 所以對 <strong>方程式</strong> 兩側作用後, 不影響求極大值的條件。<br>
(若 x<sub>1</sub>、x<sub>2</sub> 為實數 且 x<sub>1</sub>&gt;x<sub>2</sub>, 則 f(x<sub>1</sub>) &gt; f(x<sub>2</sub>)恆成立, 滿足此條件的 f(x) 稱為 <strong>嚴格遞增函數</strong>)</li>
<li>除以 n (當 n&gt;0 時, 也可視為嚴格遞增)</li>
</ol>

<p>透過使用下列對數律</p>

<ul>
<li>log<sub>a</sub> X*Y = log<sub>a</sub> X + log<sub>a</sub> Y</li>
<li>b * log<sub>a</sub> X = log<sub>a</sub> X <sup>b</sup></li>
</ul>

<p>化簡後如下 ... (式3)
<amp-img src="https://farm2.staticflickr.com/1669/25690346716_7d44c0666a.jpg" alt="Step1" width="500" height="68" layout="responsive"></amp-img></p>

<p>新定義一個函式為 G(f) = (式3), 因 L<sub>n</sub> / n = q、W<sub>n</sub> / n = p (來自於 p、q 本身的定義為勝率跟敗率), 所以得到</p>

<p>G(f) = q (ln (1-af)) + p (ln (1+bf))</p>

<p><strong>目前問題已經轉化為要求 G(f) 的最大值時, f 應該使用多少?</strong></p>

<p>這邊一階微分在數學上的意義是斜率, 所以當我們今天要找極大值相當於我們要找出斜率 = 0 的點, 所以我們先找出 G'(f) = 0 的 f 值有哪些? </p>

<p>使用 <a href="https://en.wikipedia.org/wiki/Chain_rule">Chain Rule</a> 技巧可以得到下面結果</p>

<p><amp-img src="https://farm2.staticflickr.com/1702/25719192595_02cd415376_n.jpg" alt="Step2" width="320" height="57" layout="responsive"></amp-img></p>

<p><amp-img src="https://farm2.staticflickr.com/1703/25418464200_564ea61514_n.jpg" alt="Step3" width="320" height="61" layout="responsive"></amp-img></p>

<p>因為分母 =\= 0, 所以這邊僅需要求分子 <strong>bp - aq- abf = 0</strong> 的 f 解, 透過移項後即可得到 G(f) 的極值出現在 f 為何時 (當然這邊其實還要用二階微分來求函數的凹性, 確認求出的 f 值代入 G(f) 是極大還是極小值, 但這邊省略請直接參考 <a href="https://www.math.washington.edu/~morrow/336_10/papers/jane.pdf">Jane 的文獻</a>)</p>

<p><amp-img src="https://farm2.staticflickr.com/1481/25719324655_119cc96a22_m.jpg" alt="Step4" width="240" height="92" layout="fixed"></amp-img></p>

<p>得到 (式2) 的解後, 就可以知道 (式1) 得到的 Kelly Fromula 僅是當 a 為 1 時的特殊解。</p>

<p><a href="https://www.symbolab.com">推薦Online好用的數學工具</a></p>

<hr>

<h2 id="thestockmarket">The Stock Market</h2>

<p>股票市場上的賭局並非使用固定的賠率看待, 所以這邊引入了隨機變數的概念, 用 <strong>X</strong> 表示每單位可拿回的金額 (相當於之前 Kelly Formula 裡的賠率 b), P(X = s) 則表示當 X 為 s 時發生的機率。</p>

<p><a href="http://ccckmit.wikidot.com/st:randomvariable">隨機變數參考網站</a></p>

<p>又因為今天在設法求出最佳投注資金比例 f 時, 重點不在於整個市場的機率分佈呈現是如何, 所以對機率分佈上做了以下的假設</p>

<p><code>P(X = μ + σ) = P(X = μ − σ) = 0.5 ... (式4)</code></p>

<ul>
<li>μ 為平均值</li>
<li>σ 為標準差</li>
</ul>

<p><strong>而在資金 Y 變化的公式則是由下式表示</strong></p>

<p>Y<sub>n</sub> = Y<sub>n-1</sub> (1 + (1-f)r + fX), <em>(r 表示 <strong>未</strong> 進行投注的資金獲得的報償比例)</em></p>

<p>解讀為</p>

<pre><code>現有剩餘資金 = 前次剩餘資金*(1 + 未投注市場比例*未投注報償比 + 投注市場比例*投注市場報償比) 
</code></pre>

<p>當今天進行了 n 次的投注後, 嘗試列出 <strong>現有資金</strong> 與 <strong>初始資金</strong> 間的關係, 所以這邊重新做了一次以下的假設, 使得我們經過 n 次投注後得到的總 μ, σ<sup>2</sup> and r 仍相同 (意味要將 μ, σ<sup>2</sup> and r 平均分散在 n 次的投注中)</p>

<ul>
<li><p>標準差 σ'
<amp-img src="https://farm2.staticflickr.com/1651/25203896753_b1333171ea_t.jpg" alt="Step5" width="100" height="54" layout="fixed"></amp-img>
(因為要令 σ'<sup>2</sup> * n = σ<sup>2</sup>)</p></li>
<li><p>回報率 μ'
<amp-img src="https://farm2.staticflickr.com/1692/25830684445_9488841440_t.jpg" alt="Step6" width="100" height="62" layout="fixed"></amp-img>
(因為要令 μ'* n = μ)</p></li>
<li><p>其他投資回報率 r'
<amp-img src="https://farm2.staticflickr.com/1565/25200176134_81d6ea1236_t.jpg" alt="Step7" width="100" height="63" layout="fixed"></amp-img>
(因為要令 r'* n = r)</p></li>
<li><p>將以上的變量代入一開始假設的機率分佈
<amp-img src="https://farm2.staticflickr.com/1506/25200176174_cd81ae121e.jpg" alt="Step8" width="500" height="77" layout="responsive"></amp-img></p></li>
</ul>

<p>可以導出 Y<sub>n</sub> 與 Y<sub>0</sub> 的關係式
<amp-img src="https://farm2.staticflickr.com/1579/25202372904_2b2901e3d6_n.jpg" alt="Step9" width="320" height="53" layout="responsive"></amp-img></p>

<p>將 Y<sub>0</sub> 移項至左式, 再兩邊同取 ln 後
<amp-img src="https://farm2.staticflickr.com/1520/25738035291_dc778d991b.jpg" alt="Step10" width="500" height="474" layout="responsive"></amp-img></p>

<blockquote>
  <p>回到 Kelly Formula 的討論, 我們仍是要求 G<sub>n</sub>(f) 的極大值出現在 f (資金下注比例) 為何時?</p>
</blockquote>

<p>在這部分的推導上是先將 G<sub>n</sub>(f) 以 Maclaurin 級數展開, 並令 n-&gt;∞ 時對多項式來求極值。</p>

<p><a href="https://www.flickr.com/photos/138186136@N06/25254483243/in/dateposted-public/" title="Step11"><amp-img src="https://farm2.staticflickr.com/1550/25254483243_fae5dae26b.jpg" width="375" height="500" alt="Step11" layout="responsive"></amp-img></a> <br>
(詳細的步驟可以參考我的計算過程, 跟 Jane 的有些微出入, 我猜她可能沒有實際推導後面的展開式, 所以才會在微分的結果上寫錯)</p>

<p>最後我們總算可以導出適用於市場的 Kelly Criterion。
<amp-img src="https://farm2.staticflickr.com/1518/25883526085_a10a0e006e_o.jpg" alt="Step12" width="192" height="108" layout="fixed"></amp-img></p>

            </section>

        </article>
    </main>
    <footer class="site-footer clearfix">
        <section class="copyright"><a href="../../">Hello World! I'm Vincent.</a> © 2016</section>
        <section class="poweredby">Proudly published with <a href="https://ghost.org">Ghost</a></section>
    </footer>
</body>
