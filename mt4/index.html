
<head>
    <meta charset="utf-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">

    <title>MT4</title>
    <meta name="description" content="">

    <meta name="HandheldFriendly" content="True">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">

    <link rel="shortcut icon" href="../favicon.ico">

    <link rel="stylesheet" type="text/css" href="../assets/css/screen.css?v=16480e2d13">
    <link rel="stylesheet" type="text/css" href="http://fonts.googleapis.com/css?family=Merriweather:300,700,700italic,300italic%7COpen+Sans:700,400">
    <link rel="stylesheet" type="text/css" href="../assets/css/prism.css?v=16480e2d13">
    <link rel="canonical" href="index.html">
    <meta name="referrer" content="origin">
    
    <meta property="og:site_name" content="Hello World! I'm Vincent">
    <meta property="og:type" content="article">
    <meta property="og:title" content="MT4">
    <meta property="og:description" content="MT4 (Metatrade 4) 以及 MT5 (Metatrade 5) 都是由俄羅斯公司 MetaQuotes Software Corp 所開發的交易平台, 並由各個外匯公司對該平台提供服務。 MQL4   |-- Experts (EA 又稱專家系統, 執行交易策略的文件) |-- Files (程式中使用到的外部檔案) |-- Images (程式中使用的點陣圖) |-- Include (Header檔) |-- Indicators (建立指標的文件) |-- Libraries |-- Logs |-- Presets (預設屬性區) |-- Projects...">
    <meta property="og:url" content="http://captainvincent.github.io/mt4/">
    <meta property="article:published_time" content="2016-02-24T09:18:15.605Z">
    <meta property="article:modified_time" content="2016-03-25T08:39:52.911Z">
    <meta property="article:tag" content="MT4">
    <meta property="article:tag" content="MQL4">
    <meta property="article:tag" content="外匯">
    <meta property="article:tag" content="自動交易">
    <meta property="article:tag" content="程式">
    
    <meta name="twitter:card" content="summary">
    <meta name="twitter:title" content="MT4">
    <meta name="twitter:description" content="MT4 (Metatrade 4) 以及 MT5 (Metatrade 5) 都是由俄羅斯公司 MetaQuotes Software Corp 所開發的交易平台, 並由各個外匯公司對該平台提供服務。 MQL4   |-- Experts (EA 又稱專家系統, 執行交易策略的文件) |-- Files (程式中使用到的外部檔案) |-- Images (程式中使用的點陣圖) |-- Include (Header檔) |-- Indicators (建立指標的文件) |-- Libraries |-- Logs |-- Presets (預設屬性區) |-- Projects...">
    <meta name="twitter:url" content="http://captainvincent.github.io/mt4/">
    
    <script type="application/ld+json">
{
    "@context": "http://schema.org",
    "@type": "Article",
    "publisher": "Hello World! I'm Vincent",
    "author": {
        "@type": "Person",
        "name": "Captain Vincent",
        "image": "http://captainvincent.github.io/content/images/2016/01/--.JPG",
        "url": "http://captainvincent.github.io/author/captain",
        "sameAs": null,
        "description": null
    },
    "headline": "MT4",
    "url": "http://captainvincent.github.io/mt4/",
    "datePublished": "2016-02-24T09:18:15.605Z",
    "dateModified": "2016-03-25T08:39:52.911Z",
    "keywords": "MT4, MQL4, 外匯, 自動交易, 程式",
    "description": "MT4 (Metatrade 4) 以及 MT5 (Metatrade 5) 都是由俄羅斯公司 MetaQuotes Software Corp 所開發的交易平台, 並由各個外匯公司對該平台提供服務。 MQL4   |-- Experts (EA 又稱專家系統, 執行交易策略的文件) |-- Files (程式中使用到的外部檔案) |-- Images (程式中使用的點陣圖) |-- Include (Header檔) |-- Indicators (建立指標的文件) |-- Libraries |-- Logs |-- Presets (預設屬性區) |-- Projects..."
}
    </script>

    <meta name="generator" content="Ghost 0.7">
    <link rel="alternate" type="application/rss+xml" title="Hello World! I'm Vincent" href="../rss/index.html">
    <script>
  (function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){
  (i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),
  m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)
  })(window,document,'script','//www.google-analytics.com/analytics.js','ga');

  ga('create', 'UA-73341093-1', 'auto');
  ga('send', 'pageview');

</script>
</head>
<body class="post-template tag-mt4 tag-mql4 tag-wai-hui tag-zi-dong-jiao-yi tag-cheng-shi nav-closed">

    <div class="nav">
    <h3 class="nav-title">Menu</h3>
    <a href="index.html#" class="nav-close">
        <span class="hidden">Close</span>
    </a>
    <ul>
            <li class="nav-blog-home-page" role="presentation"><a href="../">Blog Home Page</a></li>
            <li class="nav-git-book" role="presentation"><a href="https://www.gitbook.com/@captainvincent">Git Book</a></li>
            <li class="nav-aboutme" role="presentation"><a href="https://about.me/CaptainVincent">About.Me</a></li>
    </ul>
    <a class="subscribe-button icon-feed" href="../rss/index.rss">Subscribe</a>
</div>
<span class="nav-cover"></span>


    <div class="site-wrapper">

        


<header class="main-header post-head no-cover">
    <nav class="main-nav  clearfix">
        
            <a class="menu-button icon-menu" href="index.html#"><span class="word">Menu</span></a>
    </nav>
</header>

<main class="content" role="main">
    <article class="post tag-mt4 tag-mql4 tag-wai-hui tag-zi-dong-jiao-yi tag-cheng-shi">

        <header class="post-header">
            <h1 class="post-title">MT4</h1>
            <section class="post-meta">
                <time class="post-date" datetime="2016-02-24">24 February 2016</time>  on <a href="../tag/mt4/">MT4</a>, <a href="../tag/mql4/">MQL4</a>, <a href="../tag/wai-hui/">外匯</a>, <a href="../tag/zi-dong-jiao-yi/">自動交易</a>, <a href="../tag/cheng-shi/">程式</a>
            </section>
        </header>

        <section class="post-content">
            <blockquote>
  <p>MT4 (<a href="http://www.metatrader4.com/">Metatrade 4</a>) 以及 MT5 (<a href="http://www.metatrader5.com/">Metatrade 5</a>) 都是由俄羅斯公司 MetaQuotes Software Corp 所開發的交易平台, 並由各個外匯公司對該平台提供服務。</p>
</blockquote>

<pre><code class="language- language-bash">MQL4  
|-- Experts (EA 又稱專家系統, 執行交易策略的文件)
|-- Files (程式中使用到的外部檔案)
|-- Images (程式中使用的點陣圖)
|-- Include (Header檔)
|-- Indicators (建立指標的文件)
|-- Libraries
|-- Logs
|-- Presets (預設屬性區)
|-- Projects
`-- Scripts (腳本檔)
</code></pre>

<p>檔案存放路徑結構</p>

<p>MQL4/MQL5 為該交易平台所撰寫的程式語言, 語法的部分類似 C/C++ (筆者的感覺其實只是 C/C++ 的子集, 所以有學過 C/C++的人應該不太陌生), 故詳細語法在這邊不是著墨的重點。</p>

<h2 id="mql45">MQL4/5 撰寫的程式碼用途</h2>

<ul>
<li>EA 連結至特定圖表後的自動交易系統, 可用於回測</li>
<li>Indicators 編寫透過自訂公式來計算數據產生的指標</li>
<li>Scripts 執行單一功能的程式碼, 附加至圖表時會立即執行一次</li>
</ul>

<h2 id="mql4c">MQL4 語法與標準 C 不同之處</h2>

<p>  </p>

<h6 id="datatypehttpsdocsmql4combasistypes"><strong><a href="https://docs.mql4.com/basis/types">Data Type</a></strong> (範例皆轉自官方)</h6>

<ul>
<li>string</li>
</ul>

<pre><code class="language- language-clike">string svar="This is a character string";  
string svar2=StringSubstr(svar,0,4);  
Print("Copyright symbol\t\x00A9");  
FileWrite(handle,"This string contains a new line symbols \n");  
string MT4path="C:\\Program Files\\MetaTrader 4";  
</code></pre>

<p></p>

<ul>
<li>color</li>
</ul>

<pre><code class="language- language-clike">//--- Literals
C'128,128,128'    // Gray  
C'0x00,0x00,0xFF' // Blue  
//color names
clrRed               // Red  
clrYellow            // Yellow  
clrBlack             // Black  
//--- Integral representations
0xFFFFFF          // White  
16777215          // White  
0x008000          // Green  
32768             // Green  
</code></pre>

<p></p>

<ul>
<li>Datetime</li>
</ul>

<pre><code class="language- language-clike">datetime NY=D'2015.01.01 00:00';     // Time of beginning of year 2015  
datetime d1=D'1980.07.19 12:30:27';  // Year Month Day Hours Minutes Seconds  
datetime d2=D'19.07.1980 12:30:27';  // Equal to D'1980.07.19 12:30:27';  
datetime d3=D'19.07.1980 12';        // Equal to D'1980.07.19 12:00:00'  
datetime d4=D'01.01.2004';           // Equal to D'01.01.2004 00:00:00'  
datetime compilation_date=__DATE__;             // Compilation date  
datetime compilation_date_time=__DATETIME__;    // Compilation date and time  
datetime compilation_time=__DATETIME__-__DATE__;// Compilation time  
//--- Examples of declarations after which compiler warnings will be returned
datetime warning1=D'12:30:27';       // Equal to D'[date of compilation] 12:30:27'  
datetime warning2=D'';               // Equal to __DATETIME__  
</code></pre>

<p></p>

<h6 id="preprocessor"><strong>提供 Preprocessor 對程式屬性的設定</strong></h6>

<p><a href="https://docs.mql4.com/basis/preprosessor/compilation">#Properties</a> (參考官方介紹)</p>

<h2 id="mql4">MQL4 程式介紹</h2>

<h4 id="">報價系統跳動單位</h4>

<p>外匯交易單位為一手 (部份券商交易提供較小單位的操作 ex. 0.1手、0.01手), 而這邊一手實際上指的是交易量 (而非價) 的單位, <strong>一手表示為 100K 單位貨幣</strong> (依前方的貨幣為主 ex. 一手 EURUSD 的單, 金額為 100K EUR)</p>

<p>而在外匯交易的報價是以點 (Pips) 為跳動單位, 但在程式交易內的跳動則是用 Points 來替代, 包含允許滑點 (Slippage) 的參數也都是以 Points 來設定, 但 Points 在各券商報價系統中實際為何不一定 (如果報價單位有提供到步 則 1 Point = 1步, 若只有到點 則 1 Points = 1點)。</p>

<blockquote>
  <p>Pips 稱 <strong>點</strong>, 而比 Pips 再小一位數的單位則稱 <strong>小點</strong> 或是 <strong>步</strong> (1點 = 10步)</p>
</blockquote>

<h4 id="">下單種類</h4>

<ul>
<li>市價單 (OP<em>BUY, OP</em>SELL)</li>
<li>順勢單 (OP<em>BUYSTOP, OP</em>SELLSTOP)
超過指定價格買 BUY單 或 SELL單 (不保證履約價)</li>
<li>逆勢單 (OP<em>BUYLIMIT, OP</em>SELLLIMIT) 成交價在限制價格內才會買進 (會保證成交價)</li>
</ul>

<p>(外匯券商所允許的下單方式為)</p>

<ul>
<li>現價以上, 可以下 Buy-Stop, Sell-Limit</li>
<li>現價以下, 可以下 Buy-Limit, Sell-Stop
<img src="https://farm2.staticflickr.com/1577/25187105571_52e4ff737f.jpg" alt=""></li>
</ul>

<h4 id=""><strong>特殊函數</strong></h4>

<p><a href="https://docs.mql4.com/basis/function/events">More Detail</a> (參考官方介紹)</p>

<ul>
<li>OnInit()－程式起始時會執行一次</li>
<li>OnTick()－圖表 Event 會觸發執行的函式</li>
<li>OnTimer()－時間 Event 會觸發執行的函式</li>
<li>OnDeinit()－結束時會執行的函式</li>
<li>OnTester()－測試 Event 會觸發執行的函式</li>
</ul>

<h4 id="index"><strong>關於時序物件的 Index</strong></h4>

<p>當前的物件皆為 ０, 時間愈往倒退值愈大
ex. 收盤價, 今日為 Close[0], 昨日為 Close[1]...etc</p>

<h4 id="api"><strong>交易 API 介紹</strong></h4>

<p>這邊介紹一些關於撰寫 EA 時會經常使用到的 API</p>

<p><strong>Order Send</strong> : 下單 API, 預掛單也是透過此 API</p>

<pre><code class="language- language-clike">OrderSend( str symbol, int cmd=OP_BUY|OP_SELL|OP_BUYSTOP|OP_SELLSTOP|OP_BUYLIMIT|OP_SELLLIMIT, dbl volume, dbl price, int slippage, dbl stoploss, dbl takeprofit, str comment=NULL, int magic=0, dtt expiration=0, clr arrow_color=CLR_NONE )  
</code></pre>

<ul>
<li>CMD - 顧名思義, 下單可執行的操作 (四種下單操作)</li>
<li>Volume - 幾手 (外匯下單的單位)</li>
<li>Price - 價位</li>
<li>Slippage - 允許最大滑點</li>
<li>Stop Loss - 停損價位</li>
<li>Take Profit - 停利價位</li>
<li>Comment - 註解</li>
<li>Magic - 訂單識別碼</li>
<li>DTT Expiration - 此單的有效期, 大部分交易商取消</li>
<li>Arrow Color - 標記在走勢圖上的下單點, <a href="https://docs.mql4.com/constants/objectconstants/webcolors">顏色參考</a></li>
</ul>

<p><strong>Order Modify</strong> : 修改訂單的 API</p>

<pre><code class="language- language-clike">OrderModify( int ticket, dbl price, dbl stoploss, dbl takeprofit, dtt expiration, clr color=CLR_NONE )  
</code></pre>

<p></p>

<h4 id="ea"><strong>EA 程式架構</strong></h4>

<p>(待補充)</p>
        </section>

        <footer class="post-footer">


            <figure class="author-image">
                <a class="img" href="../author/captain/" style="background-image: url(../content/images/2016/01/--.JPG)"><span class="hidden">Captain Vincent's Picture</span></a>
            </figure>

            <section class="author">
                <h4><a href="../author/captain/">Captain Vincent</a></h4>

                    <p>Read <a href="../author/captain/">more posts</a> by this author.</p>
                <div class="author-meta">
                    
                    
                </div>
            </section>


            <section class="share">
                <h4>Share this post</h4>
                <a class="icon-twitter" href="https://twitter.com/intent/tweet?text=MT4&amp;url=http://captainvincent.github.io/mt4/" onclick="window.open(this.href, 'twitter-share', 'width=550,height=235');return false;">
                    <span class="hidden">Twitter</span>
                </a>
                <a class="icon-facebook" href="https://www.facebook.com/sharer/sharer.php?u=http://captainvincent.github.io/mt4/index.html" onclick="window.open(this.href, 'facebook-share','width=580,height=296');return false;">
                    <span class="hidden">Facebook</span>
                </a>
                <a class="icon-google-plus" href="https://plus.google.com/share?url=http://captainvincent.github.io/mt4/" onclick="window.open(this.href, 'google-plus-share', 'width=490,height=530');return false;">
                    <span class="hidden">Google+</span>
                </a>
            </section>

            <div id="disqus_thread"></div>
            <script>
            /**
            * RECOMMENDED CONFIGURATION VARIABLES: EDIT AND UNCOMMENT THE SECTION BELOW TO INSERT DYNAMIC VALUES FROM YOUR PLATFORM OR CMS.
            * LEARN WHY DEFINING THESE VARIABLES IS IMPORTANT: https://disqus.com/admin/universalcode/#configuration-variables
            */

            var disqus_config = function () {
                this.page.url = 'http://captainvincent.github.io/mt4/'; // Replace PAGE_URL with your page's canonical URL variable
                this.page.identifier = 'ghost-8'; // Replace PAGE_IDENTIFIER with your page's unique identifier variable
            };

            (function() { // DON'T EDIT BELOW THIS LINE
                var d = document, s = d.createElement('script');

                s.src = '//captainvincent.disqus.com/embed.js';

                s.setAttribute('data-timestamp', +new Date());
                (d.head || d.body).appendChild(s);
            })();
            </script>
            <noscript>Please enable JavaScript to view the <a href="https://disqus.com/?ref_noscript" rel="nofollow">comments powered by Disqus.</a></noscript>

        </footer>

    </article>
</main>

<aside class="read-next">
    <a class="read-next-story no-cover" href="../python-xin-shou-ru-men/">
        <section class="post">
            <h2>Python 第一步 virtualenv</h2>
            <p>剛開始接觸 Python 的時候, 最先了解到的是開發者社群的貢獻, 有別於 C/C++ 這類型語言給我的感覺, 在開發上使用第三方的函式庫, 是相當方便以及普遍的事情。   Python Package Index (PyPI)      PyPI is the default Package…</p>
        </section>
    </a>
    <a class="read-next-story prev no-cover" href="../sublime-jiao-xue/">
        <section class="post">
            <h2>Sublime Text 教學</h2>
            <p>筆者按: 網路上關於 Sublime 的教學其實已經多如繁星, 所以本篇說為教學, 充其量目的也只是敝人的備忘錄而已 (笑)。 引言 在前公司待了三年多快四年, 一直都是在 Windows 上透過 SSH 連到 Linux 的 build server 做開發,…</p>
        </section>
    </a>
</aside>




        <footer class="site-footer clearfix">
            <section class="copyright"><a href="../">Hello World! I'm Vincent</a> © 2016</section>
            <section class="poweredby">Proudly published with <a href="https://ghost.org">Ghost</a></section>
        </footer>

    </div>

    <script type="text/javascript" src="https://code.jquery.com/jquery-1.11.3.min.js"></script>
    

    <script type="text/javascript" src="../assets/js/jquery.fitvids.js?v=16480e2d13"></script>
    <script type="text/javascript" src="../assets/js/prism.js?v=16480e2d13"></script>
    <script type="text/javascript" src="http://cdn.mathjax.org/mathjax/latest/MathJax.js?config=TeX-AMS-MML_HTMLorMML"></script>
    <script type="text/x-mathjax-config">
        MathJax.Hub.Config({
            tex2jax: {
                inlineMath: [['$','$'], ['\\\\(','\\\\)']],
                processEscapes: true
            }
        });
    </script>
    <script type="text/javascript" src="../assets/js/index.js?v=16480e2d13"></script>

</body>
